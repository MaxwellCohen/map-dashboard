(this["webpackJsonpmap-dashboard"]=this["webpackJsonpmap-dashboard"]||[]).push([[0],{188:function(e,t,n){e.exports=n(391)},391:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(20),i=n.n(c),o=n(10),l=n(48),u=n(14);n(204),n(205);var s=function(){var e=Object(a.useState)(null),t=Object(o.a)(e,2),n=t[0],c=t[1],i=function(e){var t=Object(a.useRef)([]);return{onDragStarted:function(e){t.current=e.columnApi.getColumnState().map((function(e){return e.colId}))},onDragStopped:function(n){var a=n.columnApi.getColumnState().map((function(e){return e.colId}));t.current.every((function(e,t){return e===a[t]}))||e(n)}}}((function(e){})),s=i.onDragStarted,f=i.onDragStopped,d=Object(a.useState)(null),p=Object(o.a)(d,2),m=p[0],b=p[1],h=Object(u.c)((function(e){return e.data})),g=h.filteredData,v=h.titles;return r.a.createElement("div",{className:"ag-theme-alpine",style:{height:400,width:"100%",marginRight:""}},r.a.createElement(l.AgGridReact,{onGridReady:function(e){c(e.api),b(e.columnApi)},onRowDataChanged:function(){if(n){var e=[];m.getAllColumns().forEach((function(t){e.push(t.colId)})),m.autoSizeColumns(e,!1)}},onDragStarted:s,onDragStopped:f,defaultColDef:{initialWidth:100,sortable:!0,resizable:!0},columnDefs:v.map((function(e){return{headerName:e,field:e}})),rowData:g}))},f=n(167),d=n.n(f),p=n(25),m=function(e){var t=window.location.search.substring(1).split("&").map((function(e){return e.split("=").map(decodeURIComponent)})).map(b),n=Object.fromEntries(t);return e?n[e]:n},b=function(e){var t=Object(o.a)(e,2),n=t[0],a=t[1],r=void 0===a?"":a;return(r.includes("|#|")||r.includes(","))&&(r=r.split("|#|").map((function(e){return e.split(",")}))),[n,r]},h=function(e,t){Array.isArray(t)&&(t=t.join("|#|"));var n=new URLSearchParams(window.location.search);n.set(e,t),window.history.replaceState(null,null,"?"+n.toString())},g=function(e){return h("t",e),{type:"SET_TITLE",payload:{text:e}}},v=function(e){return h("mi",e),{type:"SET_COLOR_AXIS_MIN",payload:{min:e}}},O=function(e){return h("ma",e),{type:"SET_COLOR_AXIS_MAX",payload:{max:e}}},y=function(e){return e=e.sort((function(e,t){return+e[0]>+t[0]?1:-1})),h("st",e),{type:"SET_COLOR_AXIS_STOPS",payload:{stops:Object(p.a)(e)}}},j=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return{type:"SET_MAP_DATA",payload:{series:{data:Object(p.a)(e),name:t},colorAxis:{}}}},x=n(177);"undefined"!==typeof window&&(window.proj4=window.proj4||x.a);var E=window.Highcharts,A=function(){var e=Object(u.c)((function(e){return e.data})),t=e.groupData,n=e.displayField,c=e.processing,i=e.loading,o=Object(u.c)((function(e){return e.options})),l=Object(u.b)();return Object(a.useEffect)((function(){0!==t.length?l(j(t,n)):l(j())}),[t,n,l]),r.a.createElement("div",null,i?r.a.createElement("div",null,"downloading data"):null,c?r.a.createElement("div",null,"processing data"):null,r.a.createElement("div",{style:{display:c||i?"none":"block"}},r.a.createElement(d.a,{immutable:!0,highcharts:E,options:o,constructorType:"mapChart"})))},S=function(){return r.a.createElement("div",{style:{width:"50%",padding:"10px",border:"1px solid #c4c4c4"}},r.a.createElement("div",{style:{width:"600",height:"400px"}},r.a.createElement(A,null)))},w=n(443),D=n(444),_=n(24);function C(e){var t=e.values,n=e.onChange,a=e.label,c=e.value,i=e.getOptionLabel,o=e.getOptionSelected;return r.a.createElement(r.a.Fragment,null,r.a.createElement(D.a,{options:t,getOptionLabel:i,getOptionSelected:o,value:c,onChange:function(e,t){n(t)},fullWidth:!0,autoComplete:!0,includeInputInList:!0,renderInput:function(e){return r.a.createElement(w.a,Object.assign({},e,{label:a,margin:"normal"}))}}))}C.defaultProps={getOptionLabel:function(e){return Object(_.startCase)(e)},getOptionSelected:function(e){return Object(_.startCase)(e)}};var k=function(e){return{type:"LOAD_DATA_SAGA",payload:{url:e}}},T=function(e){return{type:"APPLY_FILTERS_SAGA",payload:{filteringFuncitons:e}}},F=function(e,t){return{type:"SET_DISPLAY_FIELD_SAGA",payload:{displayField:e,aggregationAction:t}}},L=n(169),P=n(170),I=function(){function e(t,n){Object(L.a)(this,e),this.arr=null!==t&&void 0!==t?t:[],this.key=null!==n&&void 0!==n?n:"",this.cache={}}return Object(P.a)(e,[{key:"_changeKey",value:function(e){e!==this.key&&(this.cache={},this.key=e)}},{key:"_addValue",value:function(e){this.arr.push(e),this.cache={}}},{key:"_display",value:function(){return 1===this.arr.length?"<br>".concat(this.value.toFixed(2)):"\n    <br>Average: ".concat(this.average.toFixed(2),"\n    <br>Count: ").concat(this.count," \n    <br>Sum: ").concat(this.sum.toFixed(2),"\n    <br>Min: ").concat(this.min.toFixed(2),"\n    <br>Max: ").concat(this.max.toFixed(2),"\n    <br>Range: ").concat(this.range.toFixed(2),"\n    ")}},{key:"_numberData",get:function(){var e=this;return this.cache.numberData||(this.cache.numberData=this.arr.map((function(t){return parseFloat(t[e.key])})).filter((function(e){return!isNaN(e)}))),this.cache.numberData}},{key:"value",get:function(){return 1!==this.arr.length||isNaN(parseFloat(this.arr[0][this.key]))?this.average:parseFloat(this.arr[0][this.key])}},{key:"average",get:function(){return this.count?this.sum/this.count:0}},{key:"count",get:function(){return this.arr.length}},{key:"_countOfNumbers",get:function(){return this._numberData.length}},{key:"max",get:function(){return void 0!==this.cache.max||(this.cache.max=Math.max.apply(Math,Object(p.a)(this._numberData))),this.cache.max}},{key:"min",get:function(){return void 0!==this.cache.min||(this.cache.min=Math.min.apply(Math,Object(p.a)(this._numberData))),this.cache.min}},{key:"sum",get:function(){return void 0!==this.cache.sum||(this.cache.sum=this._numberData.reduce((function(e,t){return e+t}),0)),this.cache.sum}},{key:"range",get:function(){return this.max-this.min}}]),e}(),R=window.Highcharts,N=Object.entries(R.mapDataIndex).flatMap((function(e){var t=Object(o.a)(e,2),n=t[0],a=t[1];return"version"!==n?Object.entries(a):[]})),M=function(){var e=Object(u.c)((function(e){return e.mapSettings})).mapInfo,t=Object(u.b)();return r.a.createElement(C,{value:e,values:N,label:"Map",onChange:function(e){t(function(e){return{type:"CHANGE_MAP_SAGA",payload:{mapInfo:e}}}(e))},getOptionLabel:function(e){return Object(_.startCase)(e[0])},getOptionSelected:function(e){return Object(_.startCase)(e[1])}})},U=Object.getOwnPropertyNames(I.prototype).filter((function(e){return"constructor"!==e&&!e.startsWith("_")})),G=function(){var e=Object(u.c)((function(e){return e.data})),t=e.titles,n=e.stateKey,a=e.displayField,c=e.aggregationAction,i=Object(u.b)();return r.a.createElement("div",{style:{width:"100%",display:"flex",flexDirection:"column"}},r.a.createElement("div",{style:{width:"100%",display:"flex",flexDirection:"row"}},r.a.createElement(M,null)),r.a.createElement("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",flex:1}},(null===t||void 0===t?void 0:t.length)?r.a.createElement("div",{style:{width:"30%"}},r.a.createElement(C,{value:n,values:t,onChange:function(e){i(function(e){return{type:"SET_STATE_AND_GROUP_SAGA",payload:{stateKey:e}}}(e))},label:"Location Key"})):null,n?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{width:"30%"}},r.a.createElement(C,{value:a,values:t,onChange:function(e){i(F(e,c))},label:"Display Field"})),r.a.createElement("div",{style:{width:"30%"}},r.a.createElement(C,{value:c,values:U,onChange:function(e){i(F(a,e))},label:"Aggregation"}))):null))},V=n(439),H=n(171),B=n(172),K=n(173),z=n(178),Y=n(17),W=n(434),X=Object(W.a)((function(e){return{container:{display:"flex",flexWrap:"wrap"},textField:{marginLeft:e.spacing(1),marginRight:e.spacing(1),width:200}}}));function $(e){var t=X();return r.a.createElement(r.a.Fragment,null,r.a.createElement(w.a,Object.assign({labelid:"date-picker-"+e.label,type:"date",className:t.textField,InputLabelProps:{shrink:!0},InputProps:{inputProps:Object(Y.a)({},e)}},e)))}var Q=n(435),q=function(e,t){return e.map((function(e){return new Date(e[t])})).filter((function(e){return!isNaN(e.getTime())}))},J=function(e){return Object(z.a)(e,"yyyy-MM-dd")},Z=function(e){var t=e.dataField,n=Object(o.a)(e.filterValues,2),c=n[0],i=void 0===c?"":c,l=n[1],s=void 0===l?"":l,f=e.onFilterValueChange,d=Object(u.c)((function(e){return e.data})).rawData,p=Object(a.useState)(""),m=Object(o.a)(p,2),b=m[0],h=m[1],g=Object(a.useState)(""),v=Object(o.a)(g,2),O=v[0],y=v[1],j=Object(a.useCallback)((function(e,t){f([e,t])}),[f]);if(Object(a.useEffect)((function(){try{var e=function(e,t){var n=q(e,t);return J(Object(B.a)(n))}(d,t),n=function(e,t){var n=q(e,t);return J(Object(Q.a)(Object(K.a)(n),1))}(d,t);h(e),y(n),i&&s||j(e,n)}catch(a){h(""),y("")}}),[t,h,y,d,j,i,s]),!t)return null;return r.a.createElement(r.a.Fragment,null,r.a.createElement($,{label:"From",min:b,max:s,value:i,onChange:function(e){var t=e.target.value;j(t,s)}}),r.a.createElement($,{label:"To",min:i,max:O,value:s,onChange:function(e){var t=e.target.value;j(i,t)}}))};Z.defaultProps={filterValues:[]};var ee=Z,te=function(e){var t=Object(o.a)(e.filterValues,1)[0],n=void 0===t?"":t,c=e.onFilterValueChange,i=Object(a.useState)(n),l=Object(o.a)(i,2),u=l[0],s=l[1];Object(a.useEffect)((function(){s(n)}),[n]);return r.a.createElement($,{label:"value",value:u,onChange:function(e){var t;(t=e.target.value)!==n&&(s(n),c([t]))}})};function ne(e){return r.a.createElement(w.a,Object.assign({fullWidth:!0},e))}var ae=function(e){var t=Object(o.a)(e.filterValues,1)[0],n=void 0===t?"":t,c=e.onFilterValueChange,i=Object(a.useState)(n),l=Object(o.a)(i,2),u=l[0],s=l[1];Object(a.useEffect)((function(){s(n)}),[n]);return r.a.createElement(ne,{label:"value",value:u,onChange:function(e){return t=e.target.value,void s(t);var t},onBlur:function(){c([u])}})},re=n(174),ce=n.n(re),ie=n(436),oe=n(446),le=n(437),ue=n(438),se=Object(_.memoize)((function(e){var t="string",n=parseFloat(e),a=new Date(e);return n.toString()===e.toString()?(t="number",e=n):isNaN(a.valueOf())||(t="date",e=a),[t,e]})),fe=function(){return!0},de=function(e,t,n,a,r){return function(c){if(!e)return fe;var i=se(e),l=Object(o.a)(i,2),u=l[0],s=l[1],f=function(e,t){switch(e){case"string":return""+t;case"date":return new Date(t);case"number":return parseFloat(t);default:return t}}(u,c[t]);switch(u){case"number":return n(f,s);case"date":return a(f,s);default:return r(f,s)}}},pe=function(e,t){if(!t)return fe;var n=Object(_.memoize)((function(e,t){return e===t})),a=Object(_.memoize)((function(e,t){return Object(oe.a)(new Date(e),t)})),r=Object(_.memoize)((function(e,t){return e===t}));return de(t,e,n,a,r)},me=function(e,t){if(!t)return fe;var n=Object(_.memoize)((function(e,t){return e>=t})),a=Object(_.memoize)((function(e,t){return Object(le.a)(new Date(e),t)})),r=Object(_.memoize)((function(e,t){return e>=t}));return de(t,e,n,a,r)},be=function(e,t){if(!t)return fe;var n=Object(_.memoize)((function(e,t){return e<=t})),a=Object(_.memoize)((function(e,t){return Object(ue.a)(new Date(e),t)})),r=Object(_.memoize)((function(e,t){return e<=t}));return de(t,e,n,a,r)},he={equals:pe,greater:me,less:be,dayOf:pe,dateAfter:me,dateBefore:be,dateBetween:function(e,t,n){return t&&n?(t=new Date(t),n=new Date(n),function(a){var r=new Date(a[e]);return!isNaN(r.getTime())&&Object(ie.a)(r,{start:t,end:n})}):fe}},ge=function(e){var t=he[e];if(t){for(var n=arguments.length,a=new Array(n>1?n-1:0),r=1;r<n;r++)a[r-1]=arguments[r];return t.apply(void 0,a)}return null},ve=Object.keys(he),Oe=function(e){var t=e.filterSettings,n=e.onFilterChange,c=e.onDelete,i=Object(u.c)((function(e){return e.data})).titles,l=Object(a.useState)(""),s=Object(o.a)(l,2),f=s[0],d=s[1],m=Object(a.useState)(""),b=Object(o.a)(m,2),h=b[0],g=b[1],v=Object(a.useState)(""),O=Object(o.a)(v,2),y=O[0],j=O[1];Object(a.useEffect)((function(){var e=Object(H.a)(t),n=e[0],a=void 0===n?"":n,r=e[1],c=void 0===r?"":r,i=e.slice(2);d(a),g(c),j(i)}),[t]);return r.a.createElement("div",{style:{display:"flex",flexDirection:"row",alignContent:"flex-start",flex:1,paddingBottom:10}},r.a.createElement("div",{style:{display:"flex",flexDirection:"row",flex:3,flexGrow:3,marginRight:8}},r.a.createElement(C,{value:f,values:ve,onChange:function(e){if(d(e),e!==t[0]){var a=Object(p.a)(t);a[0]=e,n(a)}},label:"Type"}),r.a.createElement(C,{value:h,values:i,onChange:function(e){if(g(e),e!==t[1]){var a=Object(p.a)(t);a[1]=e,n(a)}},label:"Field"})),r.a.createElement("div",{style:{display:"flex",flexDirection:"row",flex:2,flexGrow:2,alignItems:"flex-end",justifyContent:"flex-end",marginBottom:"8px"}},function(e,t,n,a,c){if(!e)return null;switch(t){case"dateBetween":return r.a.createElement(ee,{dataField:e,filterValues:n,onDataFieldChange:a,onFilterValueChange:c});case"equals":case"greater":case"less":return r.a.createElement("div",{style:{margin:"0px 8px 0 15px ",flex:1,alignContent:"flex-end"}},r.a.createElement(ae,{filterValues:n,onFilterValueChange:c}));case"dayOf":case"dateAfter":case"dateBefore":return r.a.createElement("div",{style:{margin:"0px 8px 0 15px ",flex:1}},r.a.createElement(te,{filterValues:n,onFilterValueChange:c}));default:return null}}(h,f,y,g,(function(e){e.toString()!==y.toString()&&(j(e),n([f,h].concat(Object(p.a)(e))))}))),r.a.createElement("div",{style:{display:"flex",flexDirection:"row",justifyContent:"flex-end"}},r.a.createElement(V.a,{onClick:function(){return c()},style:{marginBottom:"-8px"}},r.a.createElement(ce.a,null))))},ye=function(){var e=Object(u.c)((function(e){return e.data})).filteringFuncitons,t=Object(a.useState)(e||[]),n=Object(o.a)(t,2),c=n[0],i=n[1],l=Object(u.b)();Object(a.useEffect)((function(){i(e||[])}),[e]);return r.a.createElement("div",{style:{display:"flex",flexDirection:"column",flex:1}},c.map((function(e,t){return r.a.createElement(Oe,{key:t,filterSettings:e,onFilterChange:function(e){return function(e,t){var n=Object(p.a)(c);n[e]=t,l(T(n))}(t,e)},onDelete:function(){return function(e){var t=Object(p.a)(c);t.splice(e,1),l(T(t))}(t)}})})),r.a.createElement("div",{style:{alignSelf:"flex-end",flex:1}},r.a.createElement(V.a,{onClick:function(){i((function(e){return[].concat(Object(p.a)(e),[[]])}))}},"add filter")))},je=function(){var e=Object(u.b)(),t=Object(u.c)((function(e){var t=e.data;return null===t||void 0===t?void 0:t.url})),n=Object(a.useState)(t),c=Object(o.a)(n,2),i=c[0],l=c[1];Object(a.useEffect)((function(){t&&l(t)}),[t]);var s=function(t){l(t),h("df",""),h("a",""),h("f",[]),h("s",""),e(k(""))};return r.a.createElement("div",{style:{width:"100%"}},r.a.createElement(ne,{label:"CSV Url",value:i,onChange:function(e){return s(e.target.value)},onBlur:function(n){var a;(a=n.target.value)!==t&&e(k(a))}}))},xe=n(445),Ee=n(440),Ae=n(442),Se=n(441),we=8,De=46,_e=function(e){return"undefined"===typeof(e=e||window.event).which?e.keyCode:e.which},Ce=function(e){(function(e){return[37,39].indexOf(e.keyCode)>-1})(e)||function(e){return[De,we].indexOf(e.keyCode)>-1}(e)?e.stopPropagation():function(e){var t=_e(e);return 13===t||9===t}(e)||function(e){var t=_e(e),n=e.key?e.key:String.fromCharCode(t);return function(e){return!!/[0-9]*\.?[0-9]+/.test(e)}(e.target.value+n)}(e)||e.preventDefault&&e.preventDefault()},ke=Object(a.forwardRef)((function(e,t){var n=function(){var t,n=!0;return e.keyPress===we||e.keyPress===De?t="":e.charPress?(t=e.charPress,n=!1):(t=e.value,113===e.keyPress&&(n=!1)),{value:t,highlightAllOnFocus:n}}(),c=Object(a.useState)(n.value),i=Object(o.a)(c,2),l=i[0],u=i[1],s=Object(a.useState)(n.highlightAllOnFocus),f=Object(o.a)(s,2),d=f[0],p=f[1],m=Object(a.useRef)(null),b=e.charPress&&"1234567890.".indexOf(e.charPress)<0;return Object(a.useEffect)((function(){return window.addEventListener("keydown",Ce),function(){window.removeEventListener("keydown",Ce)}}),[]),Object(a.useImperativeHandle)(t,(function(){return{afterGuiAttached:function(){var e=m.current;if(e.focus(),d)e.select(),p(!1);else{var t=e.value?e.value.length:0;t>0&&e.setSelectionRange(t,t)}},getValue:function(){return l},isCancelBeforeStart:function(){return b},isCancelAfterEnd:function(){return l>1e6}}})),r.a.createElement("input",{ref:m,value:l,onChange:function(e){return u(e.target.value)},style:{width:"95%"}})})),Te=n(175),Fe=Object(a.forwardRef)((function(e,t){var n=Object(a.useState)(e.value),c=Object(o.a)(n,2),i=c[0],l=c[1],u=Object(a.useRef)(null);return Object(a.useImperativeHandle)(t,(function(){return{getValue:function(){return i},isPopup:function(){return!0}}})),r.a.createElement("div",{ref:u,style:{padding:"10px"}},r.a.createElement(Te.SketchPicker,{color:i,onChangeComplete:function(e){var t=e.hex;t&&l(t)}}))}));function Le(e){return[e.stop,e.color]}var Pe=function(e){var t=[];return e.api.forEachNode((function(e){return t.push(e.data)})),t.map(Le)},Ie=function(){var e=Object(u.c)((function(e){return e.options.title.text})),t=Object(u.c)((function(e){return e.options.colorAxis.min})),n=Object(u.c)((function(e){return e.options.colorAxis.max})),a=Object(u.c)((function(e){return e.options.colorAxis.stops.map((function(e,t){var n=Object(o.a)(e,2),a=n[0],r=n[1];return{stop:a,color:r,_id:t+a+r}}))})),c=function(){var e=Object(u.b)(),t=Object(u.c)((function(e){return e.options.colorAxis.stops.map((function(e,t){var n=Object(o.a)(e,2),a=n[0],r=n[1];return{stop:a,color:r,_id:t+a+r}}))}));return[function(t){var n=Pe(t);e(y(n))},function(){var n=[].concat(Object(p.a)(t.map(Le)),[[0,"#000"]]);e(y(n))},function(t){t.api.applyTransaction({remove:[t.data]});var n=Pe(t);e(y(n))},function(t){e(g(t))},function(t){e(v(t))},function(t){e(O(t))}]}(),i=Object(o.a)(c,6),s=i[0],f=i[1],d=i[2],m=i[3],b=i[4],h=i[5];return r.a.createElement("div",{style:{display:"flex",flexDirection:"column",width:"100%"}},r.a.createElement(ne,{label:"title",value:e,onChange:function(e){return m(e.target.value)}}),r.a.createElement("div",{style:{width:"100%",display:"flex",flexDirection:"row"}},r.a.createElement(ne,{label:"Color Axis Min",value:t,onChange:function(e){return b(e.target.value)}}),r.a.createElement(ne,{label:"Color Axis Max",value:n,onChange:function(e){return h(e.target.value)}}),r.a.createElement(V.a,{style:{width:"33%"},onClick:f},"Add stop")),r.a.createElement("div",{style:{width:"100%"}},r.a.createElement("div",{className:"ag-theme-alpine",style:{height:300,width:"100%"}},r.a.createElement(l.AgGridReact,{defaultColDef:{flex:1,minWidth:100,filter:!0,editable:!0},onGridReady:function(e){},onCellValueChanged:s,singleClickEdit:!0,frameworkComponents:{numericEditor:ke,colorEditor:Fe,deleteButton:function(){return r.a.createElement(V.a,{style:{width:"100%"}},"Delete")}},immutableData:!0,getRowNodeId:function(e){return e._id},rowData:a},r.a.createElement(l.AgGridColumn,{field:"stop",sortable:!0,editable:!0,cellEditor:"numericEditor"}),r.a.createElement(l.AgGridColumn,{flex:2,field:"color",editable:!0,cellEditor:"colorEditor",cellStyle:function(e){return{backgroundColor:null===e||void 0===e?void 0:e.value,color:"white",textShadow:"-1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000",letterSpacing:"2px"}}}),r.a.createElement(l.AgGridColumn,{headerName:"Delete",cellRenderer:"deleteButton",onCellClicked:d,editable:!1})))))},Re=Object(W.a)((function(e){return{root:{width:"100%"},heading:{fontSize:e.typography.pxToRem(15),fontWeight:e.typography.fontWeightRegular}}})),Ne=function(){var e=Re();return r.a.createElement(xe.a,null,r.a.createElement(Ee.a,{"aria-controls":"panel1a-content",id:"panel1a-header"},r.a.createElement(Se.a,{className:e.heading},"Data Source")),r.a.createElement(Ae.a,null,r.a.createElement(je,null)))},Me=function(){var e=Re();return r.a.createElement(xe.a,null,r.a.createElement(Ee.a,{"aria-controls":"panel4a-content",id:"panel3a-header"},r.a.createElement(Se.a,{className:e.heading},"Chart Settings")),r.a.createElement(Ae.a,null,r.a.createElement(Ie,null)))},Ue=function(){var e=Re();return r.a.createElement(xe.a,{defaultExpanded:!0},r.a.createElement(Ee.a,{"aria-controls":"panel2a-content",id:"panel3a-header"},r.a.createElement(Se.a,{className:e.heading},"Filters")),r.a.createElement(Ae.a,null,r.a.createElement(ye,null)))},Ge=function(){var e=Re();return r.a.createElement(xe.a,{defaultExpanded:!0},r.a.createElement(Ee.a,{"aria-controls":"panel3a-content",id:"panel3a-header"},r.a.createElement(Se.a,{className:e.heading},"Aggregation Settings")),r.a.createElement(Ae.a,null,r.a.createElement(G,null)))},Ve=function(){var e=Object(u.c)((function(e){return e.data})),t=e.loading,n=e.titles;return r.a.createElement("div",{style:{width:"50%",padding:"10px",border:"1px solid #c4c4c4",overflow:"scroll"}},r.a.createElement(Ne,null),t?"loading...":null,!t&&n.length?r.a.createElement(Me,null):null,n.length?r.a.createElement(r.a.Fragment,null,r.a.createElement(Ue,null),r.a.createElement(Ge,null)):null)},He=function(){var e=Object(u.b)();return Object(a.useEffect)((function(){e({type:"LOAD_FROM_URL"})}),[e]),r.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},r.a.createElement("div",{style:{textAlign:"center"}},r.a.createElement("h1",null,"Data Mapping Tool")),r.a.createElement("div",{style:{display:"flex",padding:"10px",justifyContent:"space-between",height:"422px"}},r.a.createElement(Ve,null),r.a.createElement(S,null)),r.a.createElement("div",{style:{flex:1,padding:"10px"}},r.a.createElement(s,null)))},Be=n(42);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Ke={url:"",titles:[],rawData:[],filteredData:[],stateKey:"",stateMap:{},groupData:[],displayField:"",aggregationAction:"",filteringFuncitons:[],loading:!1,processing:!1},ze=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return Object(Y.a)(Object(Y.a)(Object(Y.a)({},e),t),{},{loading:n,processing:a})},Ye={chart:{map:"countries/us/us-all",borderWidth:1},animation:{duration:1e3},legend:{layout:"vertical",align:"right",floating:!0},title:{text:""},mapNavigation:{enabled:!0},colorAxis:{min:0,max:1,stops:[[0,"#00FF00"],[.5,"#FFF"],[1,"#C40401"]]},plotOptions:{mapline:{showInLegend:!1,enableMouseTracking:!1}},series:[]},We=function(e,t){return Object(Y.a)(Object(Y.a)({},e),t)},Xe=function(e,t){return[Object(Y.a)(Object(Y.a)({dataLabels:{enabled:!0,format:"{point.name}"},keys:["hc-key","value","calc"],joinBy:"hc-key",tooltip:{headerFormat:"",pointFormatter:function(){return"<h2>".concat(this.name,"</h2><br>").concat(this.calc._display())}}},e),{},{mapData:t.map&&window.Highcharts.maps[t.map]})]},$e=n(179),Qe=n(22),qe=n.n(Qe),Je=n(176),Ze=n.n(Je),et=function(e){return function(e){var t;try{t=new URL(e)}catch(n){return!1}return"http:"===t.protocol||"https:"===t.protocol}(e)?Ze.a.get("https://map-dashboard-cors.herokuapp.com/".concat(e),{headers:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Headers":"Access-Control-Allow-Headers"}}):Promise.reject("invalid url"+e)};var tt=n(8),nt=function(e){return(""+e).replace(/[^a-z0-9]/gim,"").toUpperCase()},at=function(e){return e.features.map((function(e){return e.properties})).reduce((function(e,t){var n=t["hc-key"];return n?(Object.entries(t).forEach((function(a,r){var c=Object(o.a)(a,2),i=c[0],l=c[1];if(["labelrank","longitude","latitude","hc-middle-x","hc-middle-x","hc-middle-x"].includes(i))return e;l=nt(l),void 0===e[l]?(e[l]=n,"name"===i&&"admin2"===t["hc-group"]&&(e[l+"COUNTY"]=n)):e[l]!==n&&(e[l]=null)})),e):e}),{})},rt=function(e,t,n){if(!t)return[];var a=n.reduce((function(n,a){var r=ct(e,a[t]);return r?(n[r]||(n[r]=[r,null,new I]),n[r][2]._addValue(a),n):n}),{});return Object.values(a)},ct=function(e,t){try{return e[nt(t)]||null}catch(n){return null}},it=function(e,t){if(0===t.length)return e;var n=t.map((function(e){return ge.apply(void 0,Object(p.a)(e))})).filter(Boolean);return 0===n.length?e:e.filter((function(e){return n.every((function(t){return t(e)}))}))},ot=function(e,t,n){return t=Object(_.camelCase)(t),n.map((function(n){var a=Object(o.a)(n,3),r=a[0],c=(a[1],a[2]);return t&&e?(c._changeKey(e),[r,c[t],c]):[r,null,c]}))},lt=function(e){return e.replace(/^"(.+(?="$))"$/,"$1")},ut=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:/\t|,/,n=e.slice(0,e.indexOf("\n")).split(t).map(lt),a=e.slice(e.indexOf("\n")+1).split("\n");return[n,a.map((function(e){var a=e.split(t);return n.reduce((function(e,t,n){return a[n]&&(e[t]=lt(a[n])),e}),{})}))]},st=qe.a.mark(xt),ft=qe.a.mark(Et),dt=qe.a.mark(At),pt=qe.a.mark(St),mt=qe.a.mark(wt),bt=qe.a.mark(Dt),ht=qe.a.mark(_t),gt=qe.a.mark(kt),vt=qe.a.mark(Tt),Ot=qe.a.mark(Ft);n(390);var yt=function(e){return e.data},jt=function(e){return e.mapSettings.chart.map};function xt(e){var t,n,a,r,c,i,o,l,u;return qe.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return t=m(),n=t.df,a=void 0===n?"":n,r=t.a,c=void 0===r?"":r,i=t.f,o=void 0===i?[]:i,l=t.s,u=void 0===l?"":l,h("url",e),s.next=4,Object(tt.c)({type:"UPDATE_DISPLAY_VALUES",payload:{url:e,displayField:a,aggregationAction:c,filteringFuncitons:o,stateKey:u}});case 4:return s.abrupt("return",[a,c,o,u]);case 5:case"end":return s.stop()}}),st)}function Et(e,t,n){var a,r;return qe.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,Object(tt.d)(jt);case 2:return a=c.sent,r=at(window.Highcharts.maps[a]),n||(n=t.find((function(t){return ct(r,e[0][t])}))||""),c.next=7,Object(tt.c)({type:"UPDATE_DISPLAY_VALUES",payload:{stateMap:r,stateKey:n}});case 7:return c.abrupt("return",[n,r]);case 8:case"end":return c.stop()}}),ft)}function At(e,t,n){var a,r,c,i;return qe.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,Object(tt.d)(yt);case 2:return a=o.sent,r=a.stateMap,c=a.stateKey,o.next=7,Object(tt.b)(rt,r,c,e);case 7:return i=o.sent,o.next=10,Object(tt.b)(ot,t,n,i);case 10:return i=o.sent,o.abrupt("return",i);case 12:case"end":return o.stop()}}),dt)}function St(e){var t,n,a,r,c,i,l,u,s,f,d,p,m,b,h,g,v,O;return qe.a.wrap((function(y){for(;;)switch(y.prev=y.next){case 0:return y.prev=0,y.next=3,Object(tt.c)({type:"REQUEST_DATA"});case 3:if(t=e.payload.url){y.next=7;break}return y.next=7,Object(tt.c)({type:"LOAD_DATA_SUCCESS",payload:{}});case 7:return y.next=9,xt(t);case 9:return n=y.sent,a=Object(o.a)(n,4),r=a[0],c=a[1],i=a[2],l=a[3],y.next=17,Object(tt.b)(et,t);case 17:if(s=y.sent,console.log(s),f=s.data,!Array.isArray(f)){y.next=25;break}p=f,d=Object.keys(p[0]),y.next=31;break;case 25:return y.next=27,Object(tt.b)(ut,f);case 27:m=y.sent,b=Object(o.a)(m,2),d=b[0],p=b[1];case 31:return y.next=33,Et(p,d,l);case 33:return h=y.sent,g=Object(o.a)(h,2),l=g[0],u=g[1],y.next=39,Object(tt.b)(it,p,i);case 39:return v=y.sent,y.next=42,At(v,r,c);case 42:return O=y.sent,y.next=45,Object(tt.c)({type:"LOAD_DATA_SUCCESS",payload:{url:t,titles:d,displayField:r,rawData:p,filteredData:v,filteringFuncitons:i,aggregationAction:c,groupData:O,stateKey:l,stateMap:u}});case 45:y.next=52;break;case 47:return y.prev=47,y.t0=y.catch(0),console.log(y.t0),y.next=52,Object(tt.c)({type:"LOAD_DATA_FAILURE",message:y.t0.message});case 52:case"end":return y.stop()}}),pt,null,[[0,47]])}function wt(e){var t,n,a,r;return qe.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return c.prev=0,t=e.payload.filteringFuncitons,c.next=4,Object(tt.d)(yt);case 4:if((n=c.sent).filteringFuncitons.toString()!==t.toString()){c.next=7;break}return c.abrupt("return");case 7:return h("f",t),c.next=10,Object(tt.c)({type:"UPDATE_DISPLAY_VALUES",payload:{filteringFuncitons:t}});case 10:return c.next=12,Object(tt.b)(it,n.rawData,t);case 12:return a=c.sent,c.next=15,At(a,n.displayField,n.aggregationAction);case 15:return r=c.sent,c.next=18,Object(tt.c)({type:"ADD_FILTERS",payload:{filteringFuncitons:t,filteredData:a,groupData:r}});case 18:c.next=22;break;case 20:c.prev=20,c.t0=c.catch(0);case 22:case"end":return c.stop()}}),mt,null,[[0,20]])}function Dt(e){var t,n,a,r,c,i;return qe.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,t=e.payload.stateKey,h("s",t),o.next=5,Object(tt.c)({type:"UPDATE_DISPLAY_VALUES",payload:{stateKey:t}});case 5:return o.next=7,Object(tt.d)(yt);case 7:return n=o.sent,a=n.filteredData,r=n.displayField,c=n.aggregationAction,o.next=13,At(a,r,c);case 13:return i=o.sent,o.next=16,Object(tt.c)({type:"SET_STATE_AND_GROUP",payload:{stateKey:t,groupData:i}});case 16:o.next=20;break;case 18:o.prev=18,o.t0=o.catch(0);case 20:case"end":return o.stop()}}),bt,null,[[0,18]])}function _t(e){var t,n,a,r,c;return qe.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,t=e.payload,n=t.displayField,a=t.aggregationAction,i.next=4,Object(tt.b)(h,"df",n);case 4:return i.next=6,Object(tt.b)(h,"a",a);case 6:return i.next=8,Object(tt.d)(yt);case 8:return r=i.sent,i.next=11,Object(tt.c)({type:"UPDATE_DISPLAY_VALUES",payload:{displayField:n,aggregationAction:a}});case 11:if(!(r.groupData.length>0)){i.next=17;break}return i.next=14,Object(tt.b)(ot,n,a,r.groupData);case 14:c=i.sent,i.next=20;break;case 17:return i.next=19,At(r.filteredData,n,a);case 19:c=i.sent;case 20:return i.next=22,Object(tt.c)({type:"SET_DISPLAY_FIELD",payload:{displayField:n,aggregationAction:a,groupData:c}});case 22:i.next=26;break;case 24:i.prev=24,i.t0=i.catch(0);case 26:case"end":return i.stop()}}),ht,null,[[0,24]])}function Ct(e){return new Promise((function(t){var n=document.createElement("script");n.src="https://code.highcharts.com/mapdata/".concat(e),n.onload=t,document.body.appendChild(n)}))}function kt(e){var t,n,a,r,c,i;return qe.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(t=e.payload.mapInfo){o.next=5;break}return o.next=4,Object(tt.c)({type:"CHANGE_MAP",payload:{mapInfo:t}});case 4:return o.abrupt("return");case 5:if(h("map",t),n=t[1].replace(".js",""),a={map:n},window.Highcharts.maps[n]){o.next=11;break}return o.next=11,Object(tt.b)(Ct,t[1]);case 11:return r=at(window.Highcharts.maps[n]),o.next=14,Object(tt.c)({type:"UPDATE_STATE_MAP",payload:{stateMap:r}});case 14:return o.next=16,Object(tt.c)({type:"CHANGE_MAP",payload:{mapInfo:t,chart:a}});case 16:return o.next=18,Object(tt.d)(yt);case 18:return c=o.sent,i=c.stateKey,o.next=22,Object(tt.c)({type:"SET_STATE_AND_GROUP_SAGA",payload:{stateKey:i}});case 22:case"end":return o.stop()}}),gt)}function Tt(e){var t,n,a,r,c,i,o;return qe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log(m()),t=m("map"),n=m("url"),a=m("mi"),r=m("ma"),console.log(r),c=m("t"),i=m("st"),!t){e.next=16;break}return e.next=11,Object(tt.c)({type:"REQUEST_DATA"});case 11:return t=t.flatMap((function(e){return e})),o=t.pop(),t=[t.join(","),o],e.next=16,Object(tt.c)({type:"CHANGE_MAP_SAGA",payload:{mapInfo:t}});case 16:if(!n){e.next=33;break}return e.next=19,Object(tt.c)({type:"LOAD_DATA_SAGA",payload:{url:n}});case 19:if(!a){e.next=22;break}return e.next=22,Object(tt.c)(v(a));case 22:if(!r){e.next=26;break}return console.log("update Max",r),e.next=26,Object(tt.c)(O(r));case 26:if(!c){e.next=29;break}return e.next=29,Object(tt.c)(g(c));case 29:if(!i){e.next=33;break}return console.log(i),e.next=33,Object(tt.c)(y(i));case 33:case"end":return e.stop()}}),vt)}function Ft(){return qe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(tt.a)([Object(tt.f)("LOAD_DATA_SAGA",St),Object(tt.f)("LOAD_FROM_URL",Tt),Object(tt.e)("SET_DISPLAY_FIELD_SAGA",_t),Object(tt.e)("APPLY_FILTERS_SAGA",wt),Object(tt.e)("SET_STATE_AND_GROUP_SAGA",Dt),Object(tt.e)("CHANGE_MAP_SAGA",kt)]);case 2:case"end":return e.stop()}}),Ot)}var Lt=Ft,Pt={chart:{map:"countries/us/us-all",borderWidth:1},mapInfo:["United States of America","countries/us/us-all.js"]},It=Object($e.a)(),Rt=Object(Be.e)(Object(Be.c)({data:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ke,t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;switch(n){case"REQUEST_DATA":return ze(Ke,{},!0);case"LOAD_DATA_SUCCESS":return ze(Ke,a,!1);case"LOAD_DATA_FAILURE":return ze(Ke,{},!1);case"SET_STATE_AND_GROUP":case"SET_DISPLAY_FIELD":case"ADD_FILTERS":return ze(e,a);case"UPDATE_DISPLAY_VALUES":return ze(e,a,e.loading,!0);case"UPDATE_STATE_MAP":return ze(e,a);default:return e}},options:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ye,n=arguments.length>1?arguments[1]:void 0,a=n.type,r=n.payload;switch(a){case"CHANGE_MAP":var c=((null===t||void 0===t||null===(e=t.series[0])||void 0===e?void 0:e.data)||[]).filter((function(e){return!e.path}));return Object(Y.a)(Object(Y.a)({},t),{},{chart:Object(Y.a)(Object(Y.a)({},t.chart),r.chart),series:Xe(Object(Y.a)(Object(Y.a)({},t.series[0]),{},{data:c}),r.chart||t.chart)});case"SET_TITLE":return Object(Y.a)(Object(Y.a)({},t),{},{title:r});case"SET_COLOR_AXIS_MAX":case"SET_COLOR_AXIS_MIN":case"SET_COLOR_AXIS_STOPS":return Object(Y.a)(Object(Y.a)({},t),{},{colorAxis:We(t.colorAxis,r)});case"SET_MAP_DATA":return Object(Y.a)(Object(Y.a)({},t),{},{colorAxis:We(t.colorAxis,r.colorAxis),series:Xe(r.series,t.chart)});default:return t}},mapSettings:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Pt,t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;switch(n){case"CHANGE_MAP":return Object(Y.a)(Object(Y.a)({},e),{},{mapInfo:a.mapInfo,chart:Object(Y.a)(Object(Y.a)({},e.chart),a.chart)});default:return e}}}),Object(Be.a)(It));It.run(Lt),i.a.render(r.a.createElement(u.a,{store:Rt},r.a.createElement(He,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[188,1,2]]]);
//# sourceMappingURL=main.0fe4e457.chunk.js.map